<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>vue2原理&nbsp;|&nbsp;Notablog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="vue2原理">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🐵&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/met_jules_tavernier_1878.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🐵&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">vue2原理</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Tue, Apr 12, 2022</span>
        
        
      </div>
    
  </header>
  <article id="https://www.notion.so/524754e39fe740e28bb0ccd9755f1982" class="PageRoot PageRoot--FullWidth"><div id="https://www.notion.so/e66752bdfa3c4a63b251a3c3241ac411" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1a734ed808b2460caf1fda8a60c8b245" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0a6bf9d272eb456582b544ba5ffc57b3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0597a9ca9d5240f0a7ca013b35dd1157" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/af7a3bad9bc042a38b86eab3c0540bc2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/289cb904f9b64ca7aa0a9673c866b4a0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/bae5e908a6eb42eb8fc9f23c29eabbd2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/6d00d5b7606a407ba4efdc97b692fdd4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/05a31bc209c74993a4536bc38af1c61e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/25d31f1cccfe421da05097662920e6bd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div></div><h1 id="https://www.notion.so/4f27761b8a1a42ceaf8ca89dd023a57f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/4f27761b8a1a42ceaf8ca89dd023a57f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">组件化基础</span></span></h1><div id="https://www.notion.so/2c38177a33d54e6d890c7e9c80ecc162" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以前的jsp和nodejs都使用组件化，但是传统的组件只静态渲染，更新还要依赖于操作DOM</span></span></p></div><div id="https://www.notion.so/2eac1822a5674c46b2060a811d483672" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/26280885e71142a4bd1512664e7caf50" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/a8880a7d9c964601aca1f1d243ca7300" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a8880a7d9c964601aca1f1d243ca7300"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">MVVM（Model-View-ViewModel）</span></span></h1><h2 id="https://www.notion.so/503a6b854e504f90af0376e20529d668" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/503a6b854e504f90af0376e20529d668"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">MVVM视图</span></span></h2><div id="https://www.notion.so/403b5e7840cd43e89e389c5a73032563" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F35f9206f-a89a-4f3a-afcc-8b0e895472d1%2FUntitled.png?width=1280&amp;table=block&amp;id=403b5e78-40cd-43e8-9e38-9c5a73032563"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F35f9206f-a89a-4f3a-afcc-8b0e895472d1%2FUntitled.png?width=1280&amp;table=block&amp;id=403b5e78-40cd-43e8-9e38-9c5a73032563" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/d0efe971fb8e4af6b66d53b644fc3c1a" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8c0c34bc-90c0-46f3-93c7-b339c5ac321e%2FUntitled.png?width=1775&amp;table=block&amp;id=d0efe971-fb8e-4af6-b66d-53b644fc3c1a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8c0c34bc-90c0-46f3-93c7-b339c5ac321e%2FUntitled.png?width=1775&amp;table=block&amp;id=d0efe971-fb8e-4af6-b66d-53b644fc3c1a" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/6a6597825df74df088366e2098f607b7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">View指的是左侧的template标签中的DOM元素</span></span></li><li id="https://www.notion.so/473095d355cc4b5eacf19485fc21993c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Model指的是右侧的data中的name和list</span></span></li><li id="https://www.notion.so/e23615d2fe7541c58426ea87e5e5be86" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">View-Model指的是左侧触发DOM事件并传递给右侧的methods中→更改Model数据→更新VIew，这样的一个模型</span></span></li></ul><div id="https://www.notion.so/9e69013f409b43b09bc68e631d7fea69" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/adf8688ae2334b66b96ac0b4f019d766" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/15e35e035c1e406091794cc765ed618f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/15e35e035c1e406091794cc765ed618f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Vue响应式</span></span></h1><div id="https://www.notion.so/5eef41e0074a409e9c9d5102bf3c1677" class="Bookmark"><a href="https://juejin.cn/post/6932659815424458760"><h5 class="Bookmark__Title">掘金</h5><p class="Bookmark__Link">https://juejin.cn/post/6932659815424458760</p></a></div><div id="https://www.notion.so/71c8e5a2c57046aba29a8527e1ef7a2a" class="Bookmark"><a href="https://github.com/answershuto/learnVue"><h5 class="Bookmark__Title">GitHub - answershuto/learnVue: Vue.js 源码解析</h5><p class="Bookmark__Desc">Vue.js源码分析，记录了个人学习Vue.js源码的过程中的一些心得以及收获。以及对于Vue框架，周边库的一些个人见解。 在学习的过程中我为Vue.js（2.3.0）、Vuex（2.4.0）、Vue-router（3.0.1）加上了注释，分别在文件夹 vue-src、 vuex-src以及 vue-router-src 中，希望可以帮助有需要的同学更好地学习理解Vue.js及周边库的源码。 感谢 尤大 提高生产力。 本项目希望对Vue.js做更进一步的探索与学习，Vue.js基础内容请参考Vue.js官网， https://cn.vuejs.org/v2/guide/ 。 可能会有理解存在偏差的地方，欢迎提issue指出，共同学习，共同进步。 Vue.js响应式原理 从Vue.js源码角度再看数据绑定 VNode节点(Vue.js实现) Virtual DOM与diff(Vue.js实现) 聊聊Vue.js的template编译 Vue.js异步更新DOM策略及nextTick 从template到DOM（Vue.js源码角度看内部运行机制） 聊聊keep-alive组件的使用及其实现原理 说说element组件库broadcast与dispatch 由于以上内容都是针对 Vue.js 源码进行讲解了，可能有一些不太熟悉源码的同学读起来感觉晦涩难懂。 笔者撰写的 《剖析 Vue.js 内部运行机制》 或许可以帮到你。 作者： 染陌 Email： answershuto@gmail.com Github: https://github.com/answershuto 知乎： https://www.zhihu.com/people/cao-yang-49/activities 掘金： https://juejin.im/user/58f87ae844d9040069ca7507 对内容有任何疑问，欢迎联系我。</p><p class="Bookmark__Link">https://github.com/answershuto/learnVue</p></a></div><h2 id="https://www.notion.so/401bf13236ce45f790ab9dcd80edbe33" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/401bf13236ce45f790ab9dcd80edbe33"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.notion.so/b2515c8a5c4f49428f32eb70cd90959c#9e2a9a1e61db4004991cd2e4c6815022">Object.defineProperty</a></span></span></h2><div id="https://www.notion.so/9ceb3e15be354741bd10db9f2d08bc6e" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb35a7721-5d7c-4939-b5bc-b0d399e9ca2f%2FUntitled.png?width=1785&amp;table=block&amp;id=9ceb3e15-be35-4741-bd10-db9f2d08bc6e"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb35a7721-5d7c-4939-b5bc-b0d399e9ca2f%2FUntitled.png?width=1785&amp;table=block&amp;id=9ceb3e15-be35-4741-bd10-db9f2d08bc6e" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/93561251040a44a7ad47bf6dd47615a2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">上面的监听只可以监听简单的对象</span></span></li><li id="https://www.notion.so/dc6972642f884693a59b221267acccaa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">不能监听复杂对象的深度监听</span></span></li><li id="https://www.notion.so/5e9bdbf28dfa4ffb8138ebaa2a0e2195" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">不能监听数组</span></span></li></ul><h2 id="https://www.notion.so/21c35841a39f46e79d2d06bd22cc4c6e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/21c35841a39f46e79d2d06bd22cc4c6e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">使用defineProperty监听解决监听问题</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/5b78f1049e2e4f508b6dbbf074323c61" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对于对象，使用递归对每层的key都做observer，直到key不是对象为止</span></span></li><li id="https://www.notion.so/4321ceef908b46238c73a4a55b4a8772" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对于数组，创建arrProto对象，其原型指向Array的原型，在arrProto中修改数组执行内容（加入了视图更新），最后将要监听的数组的原型指向arrProto，这些数组调用push等方法就会执行arrProto中的改进方法，构成原型链：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">nums → arrProto → Array.prototype</code></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/94e1f43a441b422880eded95f7dfbeb5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">创建arrProto作为被监听数组的原型，防止污染全局的数组原型Array.prototype</span></span></li></ul></li></ul><pre id="https://www.notion.so/486ccec9d48844c28bf53630a984e1ce" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">const</span> oldArrayProperty <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token comment">// Object.create: 创建一个新的对象，这个对象原型指向传入参数，这个对象新增的方法不会覆盖原型的方法</span>
<span class="token comment">//   例如：arrProto.push = function(){xxx}，此时arrProto.__proto__.push不会被覆盖</span>
<span class="token keyword">const</span> arrProto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>oldArrayProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'shift'</span><span class="token punctuation">,</span> <span class="token string">'unshift'</span><span class="token punctuation">,</span> <span class="token string">'splice'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">methodName</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  arrProto<span class="token punctuation">[</span>methodName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    oldArrayProperty<span class="token punctuation">[</span>methodName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'更新视图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 解决对象嵌套对象的深度监听</span>
  <span class="token function">observer</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token comment">// 对每个属性进行监听</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">!==</span> newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
        value <span class="token operator">=</span> newValue
        <span class="token function">observer</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span>
        <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 只监听对象或者数组，不监听普通数据类型</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> target <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> target
  <span class="token punctuation">}</span>

  <span class="token comment">// 判断数组</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 将数组的原型改为arrProto，执行push操作会直接执行arrProto的push</span>
    <span class="token comment">// 而arrProto的push方法中会更新视图，同时调用arrProto的原型的真正的push方法</span>
    target<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> arrProto
  <span class="token punctuation">}</span>

  <span class="token comment">// 监听对象里面的每个属性，或者数组的每个值， for...in可以遍历对象</span>
  <span class="token comment">// 但是这样只能监听到data对象中的第一层属性，info属性中的address属性没有进行监听</span>
  <span class="token comment">// 可以在defineReactive中对每个key再进行observer操作，递归到最深层没有对象属性为止</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">defineReactive</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'taewoo'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token literal-property property">info</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">'shanghai'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">nums</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token function">observer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'kyungwon'</span>
data<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">23</span>

data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Kwon'</span><span class="token punctuation">,</span> <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">'taewoo'</span><span class="token punctuation">}</span>
<span class="token comment">// name属性之前为字符串变量，但是将其变为对象后，再改变name.firstName就不会更新了</span>
<span class="token comment">// 解决办法是对newValue也进行observer监听</span>
data<span class="token punctuation">.</span>name<span class="token punctuation">.</span>firstName <span class="token operator">=</span> <span class="token string">'Tian'</span>

data<span class="token punctuation">.</span>info<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">'dalian'</span>
<span class="token comment">// 监听数组</span>
data<span class="token punctuation">.</span>nums<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></span></span></span></code></pre><ul class="BulletedListWrapper"><li id="https://www.notion.so/ebee362d74f5437281acf86698792606" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">defineProperty的缺点</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/be2985bccdf74e2eac194e2f0a09c6c7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果监听的对象内嵌套很多层对象，则会多次递归，加载时会卡死</span></span></li><li id="https://www.notion.so/2ca879d51b7440c68bbe3e0a62916db2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">无法监听新增/删除属性，所以需要</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Vue.set</code></span><span class="SemanticString">和</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Vue.delete</code></span><span class="SemanticString">来监听</span></span></li><li id="https://www.notion.so/64b585aebd934d699287fe3dc3147f53" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">无法原生的监听数组，需要进行特殊处理（改变监听数组的原型，加入监听）</span></span></li></ul></li></ul><div id="https://www.notion.so/20c38ba2425240f3b67a0124f798c9e1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0b3767629334498ba07937657466b809" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c2ec809cac9942e086508ba0d3521943" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe17de7f2-b28f-4a41-bc83-ac7e7e15f5e4%2FA5436703-D214-4FF2-9AA9-50CD80E33F28.png?width=1792&amp;table=block&amp;id=c2ec809c-ac99-42e0-8650-8ba0d3521943"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe17de7f2-b28f-4a41-bc83-ac7e7e15f5e4%2FA5436703-D214-4FF2-9AA9-50CD80E33F28.png?width=1792&amp;table=block&amp;id=c2ec809c-ac99-42e0-8650-8ba0d3521943" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/140be5f2716a41abab79617a0575b3ff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">将周转变量封为闭包val</span></span></p></div><div id="https://www.notion.so/88f1bc7da57041e6bdda3a25a711ce2f" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd3305a79-b2a8-49d7-be2d-503085be6f7d%2FBCB30267-6645-4BDA-9F23-65AF956DD5D8.png?width=1792&amp;table=block&amp;id=88f1bc7d-a570-41e6-bdda-3a25a711ce2f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd3305a79-b2a8-49d7-be2d-503085be6f7d%2FBCB30267-6645-4BDA-9F23-65AF956DD5D8.png?width=1792&amp;table=block&amp;id=88f1bc7d-a570-41e6-bdda-3a25a711ce2f" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/a8dff434f20f44f3971f6ef5e0c0cafb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/72b74ea750104a99a1a11115851d15e1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/78a73d06fe754f81b6647121496b4c20" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/273d13e16a93482e99fe6c46faed1467" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/44be6fa4e9454b988431af01d5133964" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/1855718c60ae426f9d48709b4e4e1aef" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/1855718c60ae426f9d48709b4e4e1aef"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2. 虚拟DOM和diff算法</span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/e7f0a2deebe24309917223797955f7c3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">DOM操作非常耗费性能和时间</span></span></li><li id="https://www.notion.so/f0881acc7175470f92b355de501c7643" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">以前使用jQuery，自行控制DOM操作的时机，手动调整</span></span></li><li id="https://www.notion.so/170ccb7216e24ea1bb8d4aa3f420f214" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">而Vue是数据驱动视图，不直接操作DOM，那么是如何有效控制DOM操作的呢？</span></span></li></ul><div id="https://www.notion.so/8d1d7000be544a4f9e4fe0c8899101e1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">解决方法是用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">VDOM</code></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/e67a1fbfb1a64ddd82cd1cbd23a46ade" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">DOM操作耗费性能，JS操作快耗费小，使用JS模拟DOM结构，计算出最小的变更，尽可能少的操作DOM</span></span></li><li id="https://www.notion.so/93f9f102b8d44520864fc55709bbde8e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">也就是将DOM数据化为虚拟DOM</span></span></li></ul><div id="https://www.notion.so/6bf6e0c25dd2408d9b99210f05dd0956" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/3b048a16a3e64d64b3ec191ab9355bd9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/3b048a16a3e64d64b3ec191ab9355bd9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2.1 虚拟节点和真实节点</span></span></h2><div id="https://www.notion.so/e2534f8f83184e1f88da42612c2566a1" class="ColumnList"><div id="https://www.notion.so/e5c91c147f234407b51efa23b223e586" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/431af60f2beb41e89bb4f86b229a7343" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">虚拟节点(数据化的真实节点)</span></span></p></div><div id="https://www.notion.so/78f10ee4215d4e7d933cb3df0067a81d" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff73d0ff9-2c1e-4bfd-871b-dacd5a9bb221%2FUntitled.png?width=238&amp;table=block&amp;id=78f10ee4-215d-4e7d-933c-b3df0067a81d"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff73d0ff9-2c1e-4bfd-871b-dacd5a9bb221%2FUntitled.png?width=238&amp;table=block&amp;id=78f10ee4-215d-4e7d-933c-b3df0067a81d" style="width:238px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div><div id="https://www.notion.so/68f4500922134582ae2cdef7a52ad488" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/bda75f4980ec41a7a0bb9d25f4adc668" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">真实节点</span></span></p></div><div id="https://www.notion.so/768e5ed582e64cff98403e17f3f51124" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F574f16e0-d84d-41ad-9f95-cd04ce26efd8%2FUntitled.png?width=184&amp;table=block&amp;id=768e5ed5-82e6-4cff-9840-3e17f3f51124"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F574f16e0-d84d-41ad-9f95-cd04ce26efd8%2FUntitled.png?width=184&amp;table=block&amp;id=768e5ed5-82e6-4cff-9840-3e17f3f51124" style="width:184px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/2a2b8006b01343fda9291271297aa6b1" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">带子节点的，将子节点同样封装为对象，存在父节点的children数组中</span></span></li></ul><div id="https://www.notion.so/b0f151e416ff43eab8bdf906d58495f5" class="Divider"></div><div id="https://www.notion.so/b93c90c857024a2ea0e34c785c0a48b0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/8b707dfbd4c04e07b38e294750c14f92" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8b707dfbd4c04e07b38e294750c14f92"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2.2 新老节点替换（patch函数）规则</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/7f6eed975e304150ad078dc8220f599a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果新老节点不是同一个节点名称，则暴力删除旧的节点，重新创建新的节点</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/0d82f5c8ad854df39817600b14eb5990" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">例如老节点是div，新节点是h2，则会删除重建，会耗费性能</span></span></li></ul></li><li id="https://www.notion.so/48e0491604654caaa4269c95133480b9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果新老节点是同一个节点名称，分为一下情况</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/6f3b7cc68bb1400ca11a60727aed8d4b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">新节点没有children，则直接把旧的内容变为新的文本</span></span></li><li id="https://www.notion.so/d6a2f96df5474b55af39959a55d7f0aa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">新节点有children</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/6d8706a072034386b1f2ad8e9a3bae49" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">旧节点没有children，把旧的内容删除掉，添加新的children</span></span></li><li id="https://www.notion.so/a92ecd73e2bf41f8b3ed7030b450929d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">旧节点也有children ⇒ 按下面规则进行匹配，如果某一次匹配成功，下一次会从就第一种规则往后</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/d17db351fbd44561aa0d6a3ef0c9403e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">旧前比新前，如果相等则两者指针往后++</span></span></li><li id="https://www.notion.so/d8aefb7238774f049c711edda6333661" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果不满足第一种情况，则比较旧后和新后，如果相等则两者指针--</span></span></li><li id="https://www.notion.so/e11f7eccb5f647079c7d04246f3d001b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果不满足第二种情况，则比较旧前和新后，如果相等则旧++，新--</span></span></li><li id="https://www.notion.so/54573b5668c5440aaf0889d22aad5f50" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果不满足第三种情况，则比较旧后和新前，如果相等则旧--，新++</span></span></li><li id="https://www.notion.so/652396c9776648a29bdbb48480c8d415" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果都不满足，则在新的中查找旧前，按照以下规则查找</span></span><div id="https://www.notion.so/813da8bd2e05459f953dd5f4cf5d818b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">旧前是a，去新的中如果查找到了a，就把新前（b）添加到页面中，同时新的指针++，并在旧中查找b，找到了就将旧b设置为undefined</span></span></p></div><div id="https://www.notion.so/829a3f37ea3a46e787a39cb4635b854f" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F38edd86f-4307-470a-8371-660d75fb19ab%2FUntitled.png?width=989&amp;table=block&amp;id=829a3f37-ea3a-46e7-87a3-9cb4635b854f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F38edd86f-4307-470a-8371-660d75fb19ab%2FUntitled.png?width=989&amp;table=block&amp;id=829a3f37-ea3a-46e7-87a3-9cb4635b854f" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li><li id="https://www.notion.so/d5bfd25ca7a5437ea21245f1569a7b0b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果旧的中遇到了undefined，则跳过其</span></span></li><li id="https://www.notion.so/bfc45cd570cc4ab4babca0490b3cb1e5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">上述都不满足，则创建或删除</span></span></li></ul></li></ul></li></ul></li><li id="https://www.notion.so/a43c85abe5bc4ea9984e2831cb5f6052" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果想要提升性能，需要加入key属性，key作为唯一标识符，用来判断更改前后的节点是否为同一节点，如果是就沿用内容不删除重建</span></span></li></ul><pre id="https://www.notion.so/c9da6cdab8ad44208f7c7fbc5d9ab8bd" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// 判断两个节点是否为同一个节点(key是否相同)</span>
<span class="token keyword">function</span> <span class="token function">isSameVnode</span><span class="token punctuation">(</span><span class="token parameter">vNode1<span class="token punctuation">,</span> vNode2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> vNode1<span class="token punctuation">.</span>key <span class="token operator">===</span> vNode2<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// 新旧节点都有children的情况</span>
<span class="token comment">// 第一参数是旧节点对应真实DOM，第二参数是旧节点的children，第三参数是新节点的children</span>
<span class="token keyword">function</span> <span class="token function">updateChildren</span><span class="token punctuation">(</span><span class="token parameter">parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> newCh</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 旧前、旧后、新前、新后的指针</span>
  <span class="token keyword">let</span> oldStartIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> oldEndIndex <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newStartIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newEndIndex <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 旧前、旧后、新前、新后的虚拟节点</span>
  <span class="token keyword">let</span> oldStartNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> oldEndNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldEndIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newStartNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newEndNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span><span class="token punctuation">(</span>oldStartIndex <span class="token operator">&lt;=</span> oldEndIndex <span class="token operator">&amp;&amp;</span> newStartIndex <span class="token operator">&lt;=</span> newEndIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>oldStartNode <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      oldStartNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 第一种情况： 旧前 = 新前</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isSameVnode</span><span class="token punctuation">(</span>oldStartNode<span class="token punctuation">,</span> newStartNode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartNode<span class="token punctuation">,</span> newStartNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 更新【新前】对应的真实DOM节点</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>newStartNode<span class="token punctuation">)</span> newStartNode<span class="token punctuation">.</span>elm <span class="token operator">=</span> oldStartNode<span class="token operator">?.</span>elm<span class="token punctuation">;</span>
      oldStartNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newStartNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 第二种情况： 旧后 = 新后</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isSameVnode</span><span class="token punctuation">(</span>oldEndNode<span class="token punctuation">,</span> newEndNode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">patch</span><span class="token punctuation">(</span>oldEndNode<span class="token punctuation">,</span> newEndNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>newEndNode<span class="token punctuation">)</span> newEndNode<span class="token punctuation">.</span>elm <span class="token operator">=</span> oldEndNode<span class="token operator">?.</span>elm<span class="token punctuation">;</span>
      oldEndNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newEndNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 第三种情况： 旧前 = 新后</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isSameVnode</span><span class="token punctuation">(</span>oldStartNode<span class="token punctuation">,</span> newEndNode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">patch</span><span class="token punctuation">(</span>oldStartNode<span class="token punctuation">,</span> newEndNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>newEndNode<span class="token punctuation">)</span> newEndNode<span class="token punctuation">.</span>elm <span class="token operator">=</span> oldStartNode<span class="token operator">?.</span>elm<span class="token punctuation">;</span>
      <span class="token comment">// 将旧前插入到旧后的后面</span>
      parentElm<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>oldStartNode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span> oldEndNode<span class="token punctuation">.</span>elm<span class="token punctuation">.</span>nextSibling<span class="token punctuation">)</span><span class="token punctuation">;</span>

      oldStartNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newEndNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
    <span class="token comment">// 第四种情况： 旧后 = 新前</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isSameVnode</span><span class="token punctuation">(</span>oldEndNode<span class="token punctuation">,</span> newStartNode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">patch</span><span class="token punctuation">(</span>oldEndNode<span class="token punctuation">,</span> newStartNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>newStartNode<span class="token punctuation">)</span> newStartNode<span class="token punctuation">.</span>elm <span class="token operator">=</span> oldEndNode<span class="token operator">?.</span>elm<span class="token punctuation">;</span>
      <span class="token comment">// 将旧后插入到旧前的前面</span>
      parentElm<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>oldEndNode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span> oldStartNode<span class="token punctuation">.</span>elm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      oldEndNode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newStartNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 以上都不满足，则查找</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 创建一个对象，存旧节点中子节点的key和指针i的映射关系（判断新旧有没有相同节点）</span>
      <span class="token keyword">const</span> keyMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span>oldStartIndex<span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>oldEndIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> key <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">?.</span>key<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> keyMap<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 在旧节点中查找和新前key值匹配的节点指针</span>
      <span class="token keyword">let</span> indexInOld <span class="token operator">=</span> keyMap<span class="token punctuation">[</span>newStartNode<span class="token punctuation">.</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// 找到了</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>indexInOld<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 对找到的子节点进行备份，用于将其移动到旧前的前面</span>
        <span class="token keyword">const</span> elmMove <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>indexInOld<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 将新前内容更新到待移动子节点</span>
        <span class="token function">patchVnode</span><span class="token punctuation">(</span>elmMove<span class="token punctuation">,</span> newStartNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将旧子节点数组中的元素设置为undefined</span>
        oldCh<span class="token punctuation">[</span>indexInOld<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token comment">// 将备份内容移动到旧前的前面</span>
        parentElm<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>elmMove<span class="token punctuation">.</span>elm<span class="token punctuation">,</span> oldStartNode<span class="token punctuation">.</span>elm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 没有找到，创建该节点并添加到旧前的前面</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
        parentElm<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token function">createElement</span><span class="token punctuation">(</span>newStartNode<span class="token punctuation">)</span><span class="token punctuation">,</span> oldStartNode<span class="token punctuation">.</span>elm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      newStartNode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  

  <span class="token keyword">if</span><span class="token punctuation">(</span>oldStartIndex <span class="token operator">></span> oldEndIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> before <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIndex<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>elm<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span>newStartIndex<span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>newEndIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      parentElm<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token function">createElement</span><span class="token punctuation">(</span>newCh<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> before<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 如果old指针没有互相越过，则说明有多余的old子节点，应该删除</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span>oldStartIndex<span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>oldEndIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      parentElm<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>oldCh<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>elm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

<span class="token comment">// 根据虚拟节点生成真实节点</span>
<span class="token keyword">function</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 创建虚拟节点对应的真实DOM元素标签</span>
  <span class="token keyword">let</span> domNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>sel<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果没有子节点，只有文本</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domNode<span class="token punctuation">.</span>innerText <span class="token operator">=</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 如果有子节点，则递归添加</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> child <span class="token keyword">of</span> vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> childDomNode <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
      domNode<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>childDomNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 更新虚拟节点的elm属性，指向新生成的真实节点 </span>
  vnode<span class="token punctuation">.</span>elm <span class="token operator">=</span> domNode<span class="token punctuation">;</span>

  <span class="token keyword">return</span> domNode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>



<span class="token comment">// 当新旧节点是一个key或一个节点名称sel时</span>
<span class="token keyword">function</span> <span class="token function">patchVnode</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> newVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 新节点没有children，则不管旧节点有没有children，都直接替换</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>newVnode<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> newVnode<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    oldVnode<span class="token punctuation">.</span>elm<span class="token punctuation">.</span>innerText <span class="token operator">=</span> newVnode<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 新节点有children</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 旧节点没有children</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> oldVnode<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token comment">// 清空旧节点对应真实节点的内容</span>
      oldVnode<span class="token punctuation">.</span>elm<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token comment">// 将新节点的依次子节点添加进真实节点oldVnode.elm中</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> child <span class="token keyword">of</span> newVnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> childDom <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
        oldVnode<span class="token punctuation">.</span>elm<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>childDom<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 旧节点有children</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">updateChildren</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span> oldVnode<span class="token punctuation">.</span>children<span class="token punctuation">,</span> newVnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> newVnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 如果旧节点是真实节点，则将其转化为虚拟节点，再和新节点进行比较</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>sel <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    oldVnode <span class="token operator">=</span> <span class="token function">vnode</span><span class="token punctuation">(</span>
      oldVnode<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token keyword">undefined</span><span class="token punctuation">,</span>
      oldVnode
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 如果新旧节点的节点名称不一样，则直接删除旧的，重建新的（比如div和h2）</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>sel <span class="token operator">!==</span> newVnode<span class="token punctuation">.</span>sel<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// 创建新虚拟节点对应的真实DOM节点</span>
    <span class="token keyword">let</span> newVnodeElm <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>newVnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取旧的DOM节点</span>
    <span class="token keyword">let</span> oldVnodeElm <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>elm<span class="token punctuation">;</span>
    <span class="token comment">// 将新的DOM节点添加到页面中</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newVnodeElm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      oldVnodeElm<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>newVnodeElm<span class="token punctuation">,</span> oldVnodeElm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 删除旧的DOM节点</span>
    oldVnodeElm<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>oldVnodeElm<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
  <span class="token comment">// 新旧节点节点名称相同</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function">vnode</span><span class="token punctuation">(</span><span class="token parameter">sel<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span> text<span class="token punctuation">,</span> elm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> key <span class="token operator">=</span> data<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    sel<span class="token punctuation">,</span>
    data<span class="token punctuation">,</span>
    children<span class="token punctuation">,</span>
    text<span class="token punctuation">,</span>
    elm<span class="token punctuation">,</span>
    key
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 生成虚拟节点</span>
<span class="token keyword">function</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token parameter">sel<span class="token punctuation">,</span> data<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// 如果params是字符串，则生成的虚拟节点没有子节点</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> params <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">vnode</span><span class="token punctuation">(</span>sel<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 如果params是数组，则生成的虚拟节点有子节点</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> children <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">vnode</span><span class="token punctuation">(</span>sel<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">let</span> vnode1 <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'h2'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'vnode1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> vnode2 <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'vnode2'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> vnode3 <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'a-vnode3'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'b-vnode3'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'c-vnode3'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'d'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'d-vnode3'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> container2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1.节点名称不同</span>
<span class="token comment">// patch(container, vnode1);</span>

<span class="token comment">// 2.节点名称相同，新节点没有children</span>
<span class="token comment">// patch(container, vnode2);</span>
<span class="token comment">// patch(container2, vnode2);</span>

<span class="token comment">// 3.节点名称相同，新节点有children，旧节点没有children</span>
<span class="token comment">// patch(container, vnode3);</span>

<span class="token comment">// 4.节点名称相同，新节点有children，旧节点也有children</span>
<span class="token keyword">let</span> vnode4 <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'d'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// h('li', {key: 'e'}, 'e'),</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> vnode5 <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'e'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'d'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">patch</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> vnode4<span class="token punctuation">)</span><span class="token punctuation">;</span>
btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">patch</span><span class="token punctuation">(</span>vnode4<span class="token punctuation">,</span> vnode5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/f5a634d414124209a9a15d2bec2ccad1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ffd81e8c54be479e9ac23b0d808a2d9a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ff1661b86f0245c3be35238b5a1e2f2f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/33e2ea6031d24484af2689033d83fc20" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f9c03da98dbe46e6ae881ffe36b282c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/2da03a3ddfda470695312c1dca99b8f7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/5c3385ceeceb4552b61e1fa5e521a425" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/8ea018c3494f48caa507d96833f4bfd5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">new Vue发生了什么</span></span></p></div><div id="https://www.notion.so/fd9423cb9c1a4e7e8fc569e321d89abb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">设置uid</span></span></p></div><div id="https://www.notion.so/f0827cb719f84ff1877ef9e32ea6a804" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在Vue构造函数中执行init方法（Vue函数原型上的方法）</span></span></p></div><div id="https://www.notion.so/34533de33f9740eea602583d8fbe5540" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">执行混入initMixin（Vue），下面都是mixin的内容</span></span></p></div><div id="https://www.notion.so/8326586c109d4a35979721c72d4b8b94" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">创建Vue原型方法init</span></span></p></div><div id="https://www.notion.so/1d307eb26a2a44cbbc99f04ffca208f3" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbe5442c5-17e6-4fc9-b160-910eeefb7042%2F199604A7-622A-4D49-B237-37929992E1D3.png?width=1792&amp;table=block&amp;id=1d307eb2-6a2a-44cb-bc99-f04ffca208f3"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbe5442c5-17e6-4fc9-b160-910eeefb7042%2F199604A7-622A-4D49-B237-37929992E1D3.png?width=1792&amp;table=block&amp;id=1d307eb2-6a2a-44cb-bc99-f04ffca208f3" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/90cd2a18632149bab726819059bb04d6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">合并参数进入$vm.options</span></span></p></div><div id="https://www.notion.so/058954ad6eaf4345b789be11b22ad56a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">执行一系列初始化混入方法</span></span></p></div><div id="https://www.notion.so/09615e8ddd1d424685f25f87878478f7" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3f7a9301-126f-4136-a1ba-6e9d3c34f8cb%2F383A52B6-C38D-405F-9548-91288865A492.png?width=1792&amp;table=block&amp;id=09615e8d-dd1d-4246-85f2-5f87878478f7"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3f7a9301-126f-4136-a1ba-6e9d3c34f8cb%2F383A52B6-C38D-405F-9548-91288865A492.png?width=1792&amp;table=block&amp;id=09615e8d-dd1d-4246-85f2-5f87878478f7" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/ead766e2da0e4ae2aa54b3bb35fa4e7b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用vm.$mount将options中的el挂载</span></span></p></div><div id="https://www.notion.so/574d7d799000462097ac3ce46048b4ec" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fa1be8c4adea43fa980abefd10ecab04" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">初始化data是在initState中的initData</span></span></p></div><div id="https://www.notion.so/8c3d09f68a2242f5995deb67cb6f91c3" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd62e2bac-b7c1-449c-b671-8159d3d29b88%2F83251935-65E9-4BA2-BEED-41720F04FF35.png?width=1792&amp;table=block&amp;id=8c3d09f6-8a22-42f5-995d-eb67cb6f91c3"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd62e2bac-b7c1-449c-b671-8159d3d29b88%2F83251935-65E9-4BA2-BEED-41720F04FF35.png?width=1792&amp;table=block&amp;id=8c3d09f6-8a22-42f5-995d-eb67cb6f91c3" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f8cc02e9e73348c885843d2b09761e60" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">initData函数：判断data是否为函数，如果是就调用getData</span></span></p></div><div id="https://www.notion.so/1817522542024b9f9f362947095ddc07" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F60d385f0-8a95-410d-aa15-d72a94dbc69a%2F0B14E699-12A9-49A7-B4DC-D2F9776DBAC1.png?width=1792&amp;table=block&amp;id=18175225-4202-4b9f-9f36-2947095ddc07"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F60d385f0-8a95-410d-aa15-d72a94dbc69a%2F0B14E699-12A9-49A7-B4DC-D2F9776DBAC1.png?width=1792&amp;table=block&amp;id=18175225-4202-4b9f-9f36-2947095ddc07" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/03642f47edd846b3b1225a66106c7e47" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">getData函数：</span></span></p></div><div id="https://www.notion.so/0bed6a6cc95e4975bbe1fad515ee70e3" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc9b52d09-7bee-4757-bac9-eb1c02058ca9%2FECE57685-035B-4F70-ADF2-50194E35EA77.png?width=1792&amp;table=block&amp;id=0bed6a6c-c95e-4975-bbe1-fad515ee70e3"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc9b52d09-7bee-4757-bac9-eb1c02058ca9%2FECE57685-035B-4F70-ADF2-50194E35EA77.png?width=1792&amp;table=block&amp;id=0bed6a6c-c95e-4975-bbe1-fad515ee70e3" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/bd947f33bf85401ab2ffd995631c5494" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">比较data和mehods和props属性名，不能相同，遍历keys</span></span></p></div><div id="https://www.notion.so/119c442601124fff91e026076f7ae230" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ffd802415-babe-4bc0-ad65-9f8c708fa2ba%2FDE30EAC3-70DF-4C41-AB6D-FDF002CCBD7E.png?width=1792&amp;table=block&amp;id=119c4426-0112-4fff-91e0-26076f7ae230"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ffd802415-babe-4bc0-ad65-9f8c708fa2ba%2FDE30EAC3-70DF-4C41-AB6D-FDF002CCBD7E.png?width=1792&amp;table=block&amp;id=119c4426-0112-4fff-91e0-26076f7ae230" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/87cee69bf2034486bed0a987697eb8f1" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F219e0f2e-69e8-46de-b1cc-a5e15d6a6a13%2F5B736BFD-4D98-4CFF-AEA9-DFBB429A2F1A.png?width=1792&amp;table=block&amp;id=87cee69b-f203-4486-bed0-a987697eb8f1"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F219e0f2e-69e8-46de-b1cc-a5e15d6a6a13%2F5B736BFD-4D98-4CFF-AEA9-DFBB429A2F1A.png?width=1792&amp;table=block&amp;id=87cee69b-f203-4486-bed0-a987697eb8f1" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/e1c8717384bd47128f9d7ee0cfb3bba4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">proxy函数：</span></span></p></div><div id="https://www.notion.so/eafce9cd7edd4f4988a37e7ecc0ac833" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F67f3759c-6ae9-4b3e-841a-fae419fc5b9b%2F061525A9-2325-419F-A8F4-A26912DEF6CC.png?width=1792&amp;table=block&amp;id=eafce9cd-7edd-4f49-88a3-7e7ecc0ac833"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F67f3759c-6ae9-4b3e-841a-fae419fc5b9b%2F061525A9-2325-419F-A8F4-A26912DEF6CC.png?width=1792&amp;table=block&amp;id=eafce9cd-7edd-4f49-88a3-7e7ecc0ac833" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2cb06bb49571417bb5b4c5851074d0a9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">响应式处理data：observe函数</span></span></p></div><div id="https://www.notion.so/63d5fac141dc4e6da163737ae72ae077" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/d23398960d2b41e582e0f0fd5e1d3af6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/de9a68b51cb949eca2f28567c174c0de" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/7cac2c2f69464f1ba99611545c5e8c8c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Notablog 2019-2021</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>